<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
    <Style ss:ID="Default" ss:Name="Normal">
     <Alignment ss:Vertical="Bottom"/>
     <Borders/>
     <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>
     <Interior/>
     <NumberFormat/>
     <Protection/>
    </Style>
    <Style ss:ID="borderlinksoben">
     <Borders>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderlinksobenunten">
     <Borders>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderrechtsobenunten">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderobenunten">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderoben">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
     <Alignment ss:Vertical="Bottom" ss:WrapText="1"/>
    </Style>
    <Style ss:ID="borderrechtsoben">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderlinksunten">
     <Borders>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderunten">
     <Borders>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderlinks">
     <Borders>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderrechts">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderrechtsunten">
     <Borders>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
    <Style ss:ID="borderobenuntendick">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
     </Borders>
    </Style>
    <Style ss:ID="wrap">
      <Alignment ss:Vertical="Bottom" ss:WrapText="1"/>
    </Style>
    <Style ss:ID="borderlinksobenuntendick">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
     </Borders>
    </Style>
    <Style ss:ID="borderrechtsobenuntendick">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="2"/>
     </Borders>
    </Style>
    <Style ss:ID="heading">
     <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="18" ss:Color="#000000"
      ss:Bold="1"/>
    </Style>
    <Style ss:ID="preis">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
     <Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
     <NumberFormat
      ss:Format="_-* #,##0.00\ &quot;€&quot;_-;\-* #,##0.00\ &quot;€&quot;_-;_-* &quot;-&quot;??\ &quot;€&quot;_-;_-@_-"/>
    </Style>
    <Style ss:ID="shuttlepreis">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
     </Borders>
     <Interior ss:Color="#D9D9D9" ss:Pattern="Solid"/>
     <NumberFormat
      ss:Format="_-* #,##0.00\ &quot;€&quot;_-;\-* #,##0.00\ &quot;€&quot;_-;_-* &quot;-&quot;??\ &quot;€&quot;_-;_-@_-"/>
    </Style>
    <Style ss:ID="shuttlezwischenpreis">
     <Borders>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
     <NumberFormat
      ss:Format="_-* #,##0.00\ &quot;€&quot;_-;\-* #,##0.00\ &quot;€&quot;_-;_-* &quot;-&quot;??\ &quot;€&quot;_-;_-@_-"/>
    </Style>
    <Style ss:ID="borderobendick">
     <Borders>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
    </Style>
  </Styles>
  <Worksheet ss:Name="Sixt Abrechnung">
    <Table x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="60" ss:DefaultRowHeight="15">
    <Column ss:Index="2" ss:AutoFitWidth="0" ss:Width="76.5"/>
    <Column ss:AutoFitWidth="0" ss:Width="70"/>
    <Column ss:AutoFitWidth="0" ss:Width="150"/>
    <Column ss:AutoFitWidth="0" ss:Width="150"/>
    <Column ss:Index="8" ss:AutoFitWidth="0" ss:Width="120"/>
    <Column ss:AutoFitWidth="0" ss:Width="111"/>
    <Column ss:Index="10" ss:AutoFitWidth="0" ss:Width="150"/>
    <Column ss:Index="11" ss:AutoFitWidth="0" ss:Width="150"/>
    <Column ss:Index="14" ss:AutoFitWidth="0" ss:Width="200"/>
      <Row ss:Height="20">
          <Cell ss:StyleID="heading"><Data ss:Type="String">Abrechnung <%= @bill.print_date %></Data></Cell>
      </Row>
      <Row/>
      <Row>
        <Cell ss:StyleID="borderlinksobenuntendick"><Data ss:Type="String">ID</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">ABHOLUNG</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">LIEFERUNG Date</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">NACH</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">VON</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">KZ</Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
        <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">EUR</Data></Cell>
        <Cell ss:StyleID="borderrechtsobenuntendick"><Data ss:Type="String">KSt</Data></Cell>
      </Row>
    <% @bill.jobs.each do |job| %>
      <Row ss:Height="47">
        <Cell><Data ss:Type="Number"><%= job.id %></Data></Cell>
        <Cell><Data ss:Type="String"><%=l job.actual_collection_date unless job.actual_collection_date.nil? %></Data></Cell>
        <Cell><Data ss:Type="String"><%=l job.actual_delivery_date unless job.actual_delivery_date.nil? %></Data></Cell>
        <Cell ss:StyleID="wrap"><Data ss:Type="String"><%= job.to.complete_address %></Data></Cell>
        <Cell ss:StyleID="wrap"><Data ss:Type="String"><%= job.from.complete_address %></Data></Cell>
        <Cell><Data ss:Type="String"><%= job.registration_number %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= job.route.distance %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= job.distance %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= %></Data></Cell>
        <Cell><Data ss:Type="String"><%= job.route.get_calculation_basis %></Data></Cell>
        <Cell><Data ss:Type="Number"><%=  %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= job.price_sixt.to_s %></Data></Cell>
        <Cell><Data ss:Type="Number"><%= job.cost_center_id %></Data></Cell>
        <Cell ss:StyleID="wrap"><Data ss:Type="String"><%= job.get_shuttle_string %></Data></Cell>
      </Row>
    <% end %>
    </Table>
  </Worksheet>
  <%= @bill.drivers.each do |driver| %>
    <Worksheet ss:Name="<%= driver.fullname + "(" + driver.id.to_s + ")" %>">
      <Table x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="60" ss:DefaultRowHeight="15">
      <Column ss:Index="2" ss:AutoFitWidth="0" ss:Width="76.5"/>
     <Column ss:AutoFitWidth="0" ss:Width="70"/>
     <Column ss:AutoFitWidth="0" ss:Width="150"/>
     <Column ss:AutoFitWidth="0" ss:Width="150"/>
     <Column ss:Index="8" ss:AutoFitWidth="0" ss:Width="120"/>
     <Column ss:AutoFitWidth="0" ss:Width="111"/>
     <Column ss:Index="10" ss:AutoFitWidth="0" ss:Width="150"/>
     <Column ss:Index="11" ss:AutoFitWidth="0" ss:Width="150"/>
        <Row ss:Height="20" >
            <Cell ss:StyleID="heading"><Data ss:Type="String">Abrechnung <%= @bill.print_date %> für <%= driver.fullname %></Data></Cell>
        </Row>
        <Row/>
        <Row>
          <Cell ss:StyleID="borderlinksobenuntendick"><Data ss:Type="String">ID</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">ABHOLUNG</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">LIEFERUNG Date</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">NACH</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">VON</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">KZ</Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String"></Data></Cell>
          <Cell ss:StyleID="borderobenuntendick"><Data ss:Type="String">Shuttlefahrt</Data></Cell>
          <Cell ss:StyleID="borderrechtsobenuntendick"><Data ss:Type="String">EUR</Data></Cell>
        </Row>
      <% @bill.get_main_drives( driver ).each do |job| %>
        <Row ss:Height="47">
          <Cell ss:StyleID="borderlinksoben"><Data ss:Type="Number"><%= job.id %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%=l job.actual_collection_date unless job.actual_collection_date.nil? %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%=l job.actual_delivery_date unless job.actual_delivery_date.nil? %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%= job.to.complete_address %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%=raw job.from.complete_address %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%= job.registration_number %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="Number"><%= job.route.distance %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="Number"><%= job.distance %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="Number"><%= %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%= job.route.get_calculation_basis %></Data></Cell>
          <Cell ss:StyleID="borderoben"><Data ss:Type="String"><%= job.shuttle? ? "Ja" : "" %></Data></Cell>
          <Cell ss:StyleID="<%= job.has_shuttle? ? "shuttlezwischenpreis" : "preis" %>"><Data ss:Type="Number"><%= @bill.job_price( job, driver ).to_s %></Data></Cell>
        </Row>
        <% if job.has_shuttle? %>
          <Row><Cell ss:Index="12" ss:StyleID="borderrechts"/></Row>
          <Row><Cell ss:StyleID="borderlinks"/><Cell/><Cell/><Cell/><Cell/><Cell/><Cell/><Cell><Data ss:Type="String">Dazugehörige Shuttlefahrt: <%= job.shuttle_job.id %></Data></Cell><Cell/><Cell/><Cell/><Cell ss:StyleID="borderrechts"/></Row>
          <Row>
            <Cell ss:StyleID="borderlinks"/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell ss:StyleID="borderlinksobenunten"><Data ss:Type="String">Nach</Data></Cell>
            <Cell ss:StyleID="borderobenunten"><Data ss:Type="String">Von</Data></Cell>
            <Cell ss:StyleID="borderobenunten"><Data ss:Type="String">Distanz</Data></Cell>
            <Cell ss:StyleID="borderobenunten"><Data ss:Type="String">Personen im Wagen</Data></Cell>
            <Cell ss:StyleID="borderrechtsobenunten"><Data ss:Type="String">EUR</Data></Cell>
          </Row>
          <%= job.shuttle_job.price_driver_shuttle( job, true ).each do |breakpoint| %>
            <Row>
              <Cell ss:StyleID="borderlinks"/>
              <Cell/>
              <Cell/>
              <Cell/>
              <Cell/>
              <Cell/>
              <Cell/>
              <Cell><Data ss:Type="String"><%= breakpoint[0] %></Data></Cell>
              <Cell><Data ss:Type="String"><%= breakpoint[1] %></Data></Cell>
              <Cell><Data ss:Type="Number"><%= breakpoint[2] unless breakpoint[2] == "" %></Data></Cell>
              <Cell><Data ss:Type="Number"><%= breakpoint[3] unless breakpoint[3] == "" %></Data></Cell>
              <Cell ss:StyleID="shuttlezwischenpreis"><Data ss:Type="Number"><%= breakpoint[4] %></Data></Cell>
            </Row>
          <% end %>
          <Row>
            <Cell ss:StyleID="borderlinks"/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell/>
            <Cell><Data ss:Type="String">Gesamtpreis Fahrt</Data></Cell>
            <Cell/>
            <Cell ss:StyleID="shuttlepreis"><Data ss:Type="Number"><%= job.shuttle_job.price_driver_shuttle( job ) + job.price_driver %></Data></Cell>
          </Row>
        <% end %>
          <Row>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
            <Cell ss:StyleID="borderoben"/>
          </Row>
      <% end %>
      </Table>
    </Worksheet>
  <% end %>
</Workbook>