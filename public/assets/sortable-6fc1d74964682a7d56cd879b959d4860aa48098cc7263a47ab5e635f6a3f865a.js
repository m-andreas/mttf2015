!function(t,o){function e(t,o,e,s){this.node=t,this.current_node=o,this.new_position=e,this.old_position=s}function s(t,o,e,s){this.node=t,this.current_node=o,this.new_position=e,this.positions_updater=s}function i(t,o,e,s){this.node=t,this.current_node=o,this.new_position=e,this.positions_updater=s}function r(t){this.node=t,this.node.sortable({axis:"y",update:o.proxy(this.sortable_stop_handler,this)})}if(!o)throw new Error("jQuery required by Sortable");e.prototype.update=function(){var t=this.new_position>this.old_position?-1:1,e=-1===t?this.old_position+1:this.new_position,s=-1===t?this.new_position:this.old_position-1,i=this.current_node.data("role");o("*[data-position]",this.node).filter(function(){var t=o(this).data("position"),r=o(this).data("role");return i!==r&&t>=e&&s>=t}).each(function(){var e=o(this),s=e.data("position"),i=s+t;e.attr("data-position",i).data("position",i);var r=o('*[data-role~="position"]',e);r.length>0&&r.val(i)})},s.prototype.sort=function(){o.ajax({type:"POST",dataType:"script",url:this.current_node.data("move-url"),data:{position:this.new_position},success:o.proxy(this.sort_by_server_success,this),error:o.proxy(this.sort_by_server_error,this)})},s.prototype.sort_by_server_success=function(){this.positions_updater.update(),this.node.trigger("sortable:sort_success").trigger("sortable:stop").sortable("enable")},s.prototype.sort_by_server_error=function(){this.node.sortable("cancel").trigger("sortable:sort_error").trigger("sortable:stop").sortable("enable")},i.prototype.sort=function(){var t=o('*[data-role~="position"]',this.current_node);t.length>0?(this.positions_updater.update(),this.current_node.data("position",this.new_position),t.val(this.new_position)):console&&console.error&&console.error('Could not found any *[data-role~="position"] element for',this.current_node),this.node.trigger("sortable:sort_success").trigger("sortable:stop").sortable("enable")},r.prototype.sortable_stop_handler=function(t,o){this.node.sortable("disable").trigger("sortable:start");var r=o.item,n=r.index(),a=parseInt(r.data("position")),p=new e(this.node,r,n,a),d=r.data("move-url")?s:i,h=new d(this.node,r,n,p);h.sort()},o.fn.activerecord_sortable=function(){var t=o(this);t.each(function(){var t=o(this),e=new r(t);t.data("sortable-instance",e)})}}(window,window.jQuery);